<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Magic form with bootstrap 5</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <!--
     Lesson objectives
	- Once a user has entered data into a field this change will be saved to local storage.
	    - We don't wait until the input field lost focus.
	- After reloading the page, we retrieve data from the local storage and restore all input fields.

    My additional objectives
	- Add button for reset of local store. Update the input fields accordingly.

	What we could do better:
	â€¢ use same id less often
     -->
</head>
<body>
<nav class="container p-3 bg-dark text-white text-left my-2">
    <a id="form-link">Form</a>
    <a id="history-link">History</a>
</nav>
<form class="container">
    <label class="fw-bold" for="first-name">First name</label><br>
    <input name="first-name" id="first-name" type="text" oninput="saveChange('first-name')"/><br><br>
    <label class="fw-bold" for="last-name">Last name</label><br>
    <input name="last-name" id="last-name" type="text" oninput="saveChange('last-name')"/><br><br>
    <label class="fw-bold" for="email">Email</label><br>
    <input name="email" id="email" type="email" oninput="saveChange('email')"/><br><br>
    <label class="fw-bold" for="phone">Phone</label><br>
    <input name="phone" id="phone" type="tel" oninput="saveChange('phone')"/><br><br>
    <label class="fw-bold" for="company">Company</label><br>
    <input name="company" id="company" type="text" oninput="saveChange('company')"/><br><br>
    <label class="fw-bold" for="address">Address</label><br>
    <input class="container-sm" name="address" id="address" type="text" oninput="saveChange('address')"/><br><br>
    <button class="" name="reset-button" id="reset-button" type="button" onclick="resetForm()">Reset form</button>
    <button class="" name="submit-button" id="submit-button" type="submit">Submit form</button>
</form>

<script>
    window.onload = reloadFormData;

    /** Restore element value.
     * Restore value from local data store if value is found.
     * Restore to the default value otherwise.
     * elementId: ID of the element which value to restore. */
    function restoreElementValue(elementId) {
        const storedValue = localStorage.getItem(elementId);
        const element = document.getElementById(elementId);
        if (storedValue != null) {
            element.value = storedValue;
        } else {
            element.value = element.defaultValue;
        }
    }

    /** fill input fields with value from local save if available*/
    function reloadFormData() {
        restoreElementValue("first-name");
        restoreElementValue("last-name");
        restoreElementValue("email");
        restoreElementValue("phone");
        restoreElementValue("company")
        restoreElementValue("address");
    }

    function saveChange(changedElementId) {
        console.trace("saveChange() changedElementId: " + changedElementId)
        const elementValue = document.getElementById(changedElementId).value;
        localStorage.setItem(changedElementId, elementValue);
        }

    /** Reset the form (visible part and stored data). */
    function resetForm() {
        localStorage.clear();
        reloadFormData();
        console.trace("local storage was cleared.")
    }
</script>

</body>
</html>
